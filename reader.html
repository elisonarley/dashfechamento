<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoramento RSS - Feed & Carrossel (Auto-Refresh)</title>
    <!-- Carregamento do Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    </style>

    <!-- Configura√ß√£o do Tailwind para tema escuro moderno -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-bg': '#0f0f0f', // Fundo principal bem escuro
                        'secondary-bg': '#1a1a1a', // Fundo de cards/elementos
                        'card-bg': '#242424', // Fundo dos cards RSS
                        'text-light': '#f5f5f5', // Texto claro
                        'text-muted': '#a0a0a0', // Texto secund√°rio/cinza
                        'brand-purple': '#5d3fd3', // Roxo vibrante
                        'highlight-new': '#ffc107', // Amarelo/Laranja para destaque de novo item
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f0f0f;
            color: #f5f5f5;
        }
        /* Oculta a scrollbar horizontalmente no carrossel, mantendo a funcionalidade */
        .carousel-track {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .carousel-track::-webkit-scrollbar {
            display: none;
        }
        /* Estilo para anima√ß√£o de destaque (NOVO) */
        .highlight-pulse {
            animation: pulse-border 1.5s infinite;
        }
        @keyframes pulse-border {
            0%, 100% { border-color: rgba(255, 193, 7, 0.9); }
            50% { border-color: rgba(255, 193, 7, 0.4); }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- T√≠tulo Principal e Contador de Refresh -->
        <header class="mb-10 pb-4 border-b border-gray-800 flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-3xl md:text-4xl font-extrabold text-brand-purple tracking-tight mb-3 md:mb-0">
                üî• Dashboard de Monitoramento de Feeds RSS
            </h1>
            <div id="refresh-timer" class="p-2 px-4 rounded-full bg-secondary-bg text-text-light border border-brand-purple shadow-md flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-highlight-new animate-spin" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.564 1 1 0 11-1.668 1.096A5.002 5.002 0 005.101 6.1L6.5 7.5a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L5.101 5.9A7.002 7.002 0 0117 10a1 1 0 112 0 9 9 0 11-1.748-5.195 1 1 0 01.32-.352 1 1 0 011.233 1.588A7.001 7.001 0 014 10a1 1 0 11-2 0 9 9 0 007-8.816V3a1 1 0 011-1z" clip-rule="evenodd" />
                </svg>
                Pr√≥ximo Refresh: <span id="countdown" class="font-mono font-bold ml-2 text-highlight-new">300</span>s
            </div>
        </header>

        <!-- Container para o Dashboard de RSS -->
        <div id="rss-dashboard-container" class="space-y-12">
            <div class="text-center text-text-muted mt-20" id="loading-message">
                Carregando feeds e iniciando monitoramento...
            </div>
        </div>
        
    </div>

    <script>
        // --- CONFIGURA√á√ïES E DADOS SIMULADOS ---
        const REFRESH_INTERVAL_SECONDS = 5 * 60; // 5 minutos (300 segundos)

        // Estrutura de dados SIMULADA. Na vida real, seria o resultado de um endpoint backend.
        // O campo `isNew: true` simula um novo item n√£o lido.
        const RSS_FEED_DATA = [
            {
                sourceName: "AnyMarket Status Page",
                sourceUrl: "https://status.anymarket.com.br/",
                icon: "üõí",
                items: [
                    { title: "Instabilidade na Conex√£o API Mercado Livre", pubDate: "2025-11-17T15:30:00Z", summary: "Identificada lat√™ncia elevada nas chamadas de produtos para o Mercado Livre. Time atuando.", link: "https://status.anymarket.com.br/", isNew: true },
                    { title: "RESOLVIDO: Problema de Disco no Servidor X", pubDate: "2025-11-17T14:45:00Z", summary: "Aumento de capacidade realizado. Servi√ßo normalizado.", link: "https://status.anymarket.com.br/", isNew: false },
                    { title: "Manuten√ß√£o programada na Integra√ß√£o B2W", pubDate: "2025-11-16T22:00:00Z", summary: "Manuten√ß√£o ocorrer√° das 02:00 √†s 04:00 do dia 18/11. Servi√ßo ficar√° indispon√≠vel.", link: "https://status.anymarket.com.br/", isNew: false },
                ]
            },
            {
                // Regi√£o monitorada alterada para: us-east-1 (N. Virginia)
                sourceName: "AWS Health Dashboard (us-east-1)",
                // LINK CORRIGIDO: Usando a URL geral de status da AWS.
                sourceUrl: "https://status.aws.amazon.com/",
                icon: "‚òÅÔ∏è",
                items: [
                    // Item novo simulado, mantendo a data original, mas representando a nova regi√£o
                    { title: "Degrada√ß√£o: Amazon RDS - Problemas de Conex√£o", pubDate: "2025-11-17T16:50:00Z", summary: "Investigando aumento de falhas de conex√£o em alguns clusters RDS na US-EAST-1.", link: "https://status.aws.amazon.com/", isNew: true },
                    { title: "Instabilidade no Servi√ßo Amazon S3", pubDate: "2025-11-17T15:40:00Z", summary: "Aumento de taxa de erros em requisi√ß√µes PUT e POST.", link: "https://status.aws.amazon.com/", isNew: false },
                    { title: "Normaliza√ß√£o do Servi√ßo EC2", pubDate: "2025-11-17T10:00:00Z", summary: "Todas as inst√¢ncias operando normalmente.", link: "https://status.aws.amazon.com/", isNew: false },
                ]
            },
            {
                sourceName: "Microsoft 365 Service Health",
                sourceUrl: "https://status.office.com/",
                icon: "üè¢",
                items: [
                    // Item novo simulado para destaque
                    { title: "Evento de Servi√ßo: OneDrive - Sincroniza√ß√£o", pubDate: "2025-11-17T17:10:00Z", summary: "Usu√°rios podem ter problemas de sincroniza√ß√£o. Time de engenharia trabalhando.", link: "https://status.office.com/", isNew: true },
                    { title: "RESOLVIDO: Problema de login no Teams", pubDate: "2025-11-17T12:00:00Z", summary: "Problema resolvido ap√≥s rollback. Monitorando a estabilidade.", link: "https://status.office.com/", isNew: false },
                    { title: "Manuten√ß√£o no Exchange Online", pubDate: "2025-11-15T09:00:00Z", summary: "Manuten√ß√£o conclu√≠da sem interrup√ß√µes maiores.", link: "https://status.office.com/", isNew: false },
                ]
            },
            {
                sourceName: "Equinix Status Page",
                sourceUrl: "https://status.equinix.com/",
                icon: "üîå",
                items: [
                    { title: "Manuten√ß√£o de Rotina no IBX SP3", pubDate: "2025-11-17T10:00:00Z", summary: "Aviso de manuten√ß√£o de infraestrutura agendada para 25/11.", link: "https://status.equinix.com/", isNew: false },
                    { title: "Alerta de Temperatura no Datacenter Rio", pubDate: "2025-11-16T09:00:00Z", summary: "Pico de temperatura mitigado por resfriamento auxiliar. Sem impacto em clientes.", link: "https://status.equinix.com/", isNew: false },
                    { title: "Notifica√ß√£o de Atualiza√ß√£o de Rede Global", pubDate: "2025-11-15T10:00:00Z", summary: "Atualiza√ß√µes de seguran√ßa aplicadas √† infraestrutura de rede.", link: "https://status.equinix.com/", isNew: false },
                ]
            }
        ];


        // --- FUN√á√ïES DE RENDERIZA√á√ÉO ---

        // Fun√ß√£o para formatar a data de forma relativa
        function formatRelativeTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInMinutes = Math.floor((now - date) / (1000 * 60));

            if (diffInMinutes < 1) return "Agora mesmo";
            if (diffInMinutes < 60) return `${diffInMinutes} min atr√°s`;
            if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}h atr√°s`;
            return date.toLocaleDateString('pt-BR');
        }

        // Fun√ß√£o para criar o Card de Item RSS (dentro do carrossel)
        function createRssItemCard(item, index) {
            // Aplica classes de destaque se isNew for verdadeiro
            const isNewClass = item.isNew ? 'border-4 border-highlight-new highlight-pulse' : 'border-gray-700';
            const newLabel = item.isNew ? '<span class="ml-2 px-2 py-0.5 text-xs font-bold rounded-full bg-highlight-new text-primary-bg shadow-lg whitespace-nowrap">üî• NOVO!</span>' : '';

            // Renderiza o item
            // O target="_blank" garante que a p√°gina abra em uma nova aba.
            return `
                <a href="${item.link}" target="_blank" class="flex-shrink-0 w-80 h-full p-4 bg-card-bg rounded-lg shadow-xl border ${isNewClass} transition-all duration-300 transform hover:scale-[1.02] hover:shadow-2xl cursor-pointer snap-center">
                    <div class="flex items-start justify-between mb-2">
                        <p class="text-sm font-semibold text-brand-purple flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-2.81A2.032 2.032 0 0118 14.28V11a6 6 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.138 6 8.358 6 11v3.28a2.032 2.032 0 01-.595.632L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                            </svg>
                            √öltima Atualiza√ß√£o
                            ${newLabel}
                        </p>
                    </div>
                    <h4 class="text-lg font-bold text-text-light truncate" title="${item.title}">
                        ${item.title}
                    </h4>
                    <p class="text-xs text-text-muted mt-1 mb-3">
                        Publicado: ${formatRelativeTime(item.pubDate)}
                    </p>
                    <p class="text-sm text-text-light line-clamp-3">
                        ${item.summary}
                    </p>
                </a>
            `;
        }

        // Fun√ß√£o principal para criar o Card da Fonte RSS (com o carrossel)
        function createRssSourceCard(source) {
            // Ordena os itens para garantir que o mais recente (ou novo) esteja √† esquerda
            const sortedItems = source.items.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
            const itemsHtml = sortedItems.map(createRssItemCard).join('');

            return `
                <div class="bg-secondary-bg rounded-xl shadow-2xl p-6 border-l-4 border-brand-purple">
                    <div class="flex items-center justify-between mb-6 pb-2 border-b border-gray-800">
                        <h2 class="text-2xl font-bold text-text-light flex items-center">
                            <span class="text-3xl mr-3">${source.icon}</span>
                            ${source.sourceName}
                        </h2>
                        <a href="${source.sourceUrl}" target="_blank" class="text-sm text-brand-purple hover:text-highlight-new transition duration-200 font-semibold">
                            Acessar Fonte Original &rarr;
                        </a>
                    </div>

                    <!-- Carrossel de √öltimas Atualiza√ß√µes (Horizontal Scroll) -->
                    <div class="relative">
                        <div id="carousel-${source.sourceName.replace(/\s/g, '-')}" class="carousel-track flex space-x-4 overflow-x-auto p-2 snap-x snap-mandatory pb-4">
                            ${itemsHtml.length > 0 ? itemsHtml : `<p class="text-text-muted">Nenhum item recente encontrado.</p>`}
                        </div>
                    </div>
                </div>
            `;
        }

        // Fun√ß√£o principal para renderizar o dashboard
        function initRssDashboard() {
            const container = document.getElementById('rss-dashboard-container');
            container.innerHTML = RSS_FEED_DATA.map(createRssSourceCard).join('');
            
            // Simula que ap√≥s o refresh, os itens "novos" s√£o marcados como lidos
            RSS_FEED_DATA.forEach(source => {
                source.items.forEach(item => {
                    item.isNew = false;
                });
            });

            // Se for um refresh subsequente, podemos adicionar um feedback visual
            const now = new Date().toLocaleTimeString('pt-BR');
            console.log(`[${now}] Dashboard Atualizado!`);
        }

        // --- L√ìGICA DO TIMER DE REFRESH ---
        let timerInterval;
        let countdown = REFRESH_INTERVAL_SECONDS;

        function updateCountdown() {
            countdown--;
            document.getElementById('countdown').textContent = countdown;

            if (countdown <= 0) {
                // Parar o timer atual
                clearInterval(timerInterval);
                
                // Exibe uma mensagem de atualiza√ß√£o
                document.getElementById('countdown').textContent = '0';
                document.getElementById('rss-dashboard-container').innerHTML = `
                    <div class="text-center p-8 bg-card-bg rounded-xl border border-highlight-new animate-pulse">
                        <p class="text-xl font-bold text-highlight-new">üîÑ REFRESH AUTOM√ÅTICO...</p>
                        <p class="text-sm text-text-muted mt-1">Simulando a busca de novos dados do backend.</p>
                    </div>
                `;

                // Simula um pequeno delay antes de carregar os novos dados
                setTimeout(() => {
                    // 1. Chamar a fun√ß√£o principal de renderiza√ß√£o
                    initRssDashboard();
                    
                    // 2. Reiniciar o contador
                    countdown = REFRESH_INTERVAL_SECONDS;
                    startRefreshTimer();
                }, 1000); // 1 segundo de "simula√ß√£o de busca"
            }
        }

        function startRefreshTimer() {
            // Garante que n√£o h√° timers duplicados
            if (timerInterval) clearInterval(timerInterval);
            
            // Inicia o timer para chamar a atualiza√ß√£o do contador a cada segundo
            timerInterval = setInterval(updateCountdown, 1000);
            
            // Garante que o contador comece no valor correto imediatamente
            document.getElementById('countdown').textContent = countdown;
        }

        // --- INICIALIZA√á√ÉO ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Renderiza o dashboard na carga inicial
            initRssDashboard();
            
            // 2. Inicia o timer de auto-refresh
            startRefreshTimer();
        });
    </script>
</body>
</html>