<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Diário de Bordo de Monitoramento - Black Friday 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* One UI Dark Palette */
      --bg-color: #000000;
      --surface-color: #1C1C1E; /* Cinza escuro Samsung */
      --surface-color-highlight: #2C2C2E;
      
      /* Cores de Acento One UI */
      --samsung-blue: #3E91FF;
      --samsung-red: #FF453A;
      --samsung-orange: #FF9F0A;
      --samsung-green: #32D74B;
      --text-primary: #FFFFFF;
      --text-secondary: #98989E;
      
      /* Backgrounds de Status (Pastel/Suave) */
      --bg-red-subtle: rgba(255, 69, 58, 0.15);
      --bg-orange-subtle: rgba(255, 159, 10, 0.15);
      --bg-green-subtle: rgba(50, 215, 75, 0.15);
      --bg-blue-subtle: rgba(62, 145, 255, 0.15);

      --border-radius-card: 26px;
      --border-radius-inner: 18px;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.5;
      padding: 0;
      /* Simula a rolagem nativa suave */
      scroll-behavior: smooth;
    }

    /* Container Principal */
    .app-container {
      max-width: 800px; /* Largura típica de visualização móvel/tablet esticada */
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* === Viewing Area (Cabeçalho One UI) === */
    .header-area {
      padding: 60px 24px 20px 24px; /* Padding top grande para simular Viewing Area */
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .header-subtitle {
      font-size: 14px;
      color: var(--samsung-blue);
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    h1 {
      margin: 0;
      font-size: 34px;
      font-weight: 700; /* Título Bold One UI */
      color: var(--text-primary);
    }
    
    /* Estilo para o timestamp de atualização */
    .update-timestamp {
        font-size: 12px;
        color: var(--text-secondary);
        margin-top: 5px;
        font-family: 'JetBrains Mono', monospace;
    }


    /* === Date Selector & Filter Button === */
    .controls-area {
      padding: 10px 24px 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .filter-button {
      background-color: var(--samsung-red);
      color: var(--text-primary);
      padding: 14px 24px;
      border: none;
      border-radius: var(--border-radius-card);
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      transition: background-color 0.2s, transform 0.1s;
      box-shadow: 0 4px 15px rgba(255, 69, 58, 0.4);
    }
    .filter-button:hover {
      background-color: #cc372f;
    }
    .filter-button:active {
      transform: scale(0.98);
    }
    .filter-button.inactive {
        background-color: var(--surface-color);
        box-shadow: none;
        color: var(--text-secondary);
    }
    .filter-button.inactive .blink {
        animation: none; /* Desativa a animação quando o botão está inativo/filtrando */
    }
    .filter-button.active-filter {
        background-color: var(--samsung-blue);
        box-shadow: 0 4px 15px rgba(62, 145, 255, 0.4);
    }
    
    .filter-count {
      background-color: var(--surface-color-highlight);
      color: var(--samsung-red);
      padding: 2px 10px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 700;
    }

    .select-wrapper {
      position: relative;
      display: inline-block;
      width: 100%;
    }

    select {
      appearance: none;
      -webkit-appearance: none;
      width: 100%;
      padding: 16px 24px;
      font-size: 16px;
      font-family: 'Roboto', sans-serif;
      font-weight: 500;
      border-radius: var(--border-radius-card);
      border: none;
      background-color: var(--surface-color);
      color: var(--text-primary);
      cursor: pointer;
      transition: background 0.2s ease;
    }

    select:focus {
      outline: none;
      background-color: var(--surface-color-highlight);
    }

    /* Seta customizada para o select */
    .select-wrapper::after {
      content: '▼';
      font-size: 12px;
      color: var(--text-secondary);
      position: absolute;
      right: 24px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
    }
    
    /* Container para a Lista de Incidentes Abertos (abaixo do botão) */
    #openIncidentsContainer {
        padding: 0 16px;
        margin-top: 10px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #openIncidentsList {
        display: flex;
        flex-direction: column;
        gap: 16px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.6s cubic-bezier(0.4, 0, 0.2, 1), padding 0.6s;
    }
    
    #openIncidentsList.expanded {
        max-height: 2000px; /* Valor alto para garantir expansão */
        padding-top: 20px;
    }
    
    #openIncidentsList h2 {
        padding-left: 8px;
        margin-top: 0;
    }

    /* Estilo para os cards clonados no filtro */
    .open-incident-clone {
        border: 2px solid var(--samsung-red); /* Borda destacada para urgência */
        background-color: var(--surface-color-highlight);
        transform: scale(0.98); /* Levemente menor para diferenciar do dia ativo */
        transition: transform 0.2s;
    }
    .open-incident-clone .toggle-text {
      color: var(--samsung-blue);
      font-weight: 700;
    }


    /* === Conteúdo das Datas === */
    .content { 
      padding: 0 16px 40px; /* Margens laterais menores para cards largos */
      display: none; 
      animation: fadeUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); /* Curva One UI */
    }
    .content.active { 
      display: flex; 
      flex-direction: column;
      gap: 16px;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      font-size: 18px;
      color: var(--text-secondary);
      font-weight: 500;
      margin: 10px 8px 10px; /* Alinhado com os cards */
      padding-left: 8px;
    }

    /* === Cards de Eventos (Estilo Bolha) === */
    .event {
      background-color: var(--surface-color);
      border-radius: var(--border-radius-card);
      overflow: hidden;
      transition: background-color 0.2s, opacity 0.3s, max-height 0.3s;
      /* Propriedades para controle de filtro */
      max-height: 500px;
      opacity: 1;
    }
    
    /* Esta classe agora é inútil, mas mantida para evitar quebras em transições */
    .event.hidden-by-filter {
        /* max-height, opacity, etc. devem ser controlados no JS, mas mantidos para CSS de transição */
        display: none; 
    }

    .event:active {
      background-color: var(--surface-color-highlight); /* Feedback de toque */
    }

    .event-header {
      padding: 20px 24px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start; /* Alinhamento topo para textos longos */
      cursor: pointer;
      user-select: none;
      gap: 16px;
    }

    /* Título do Evento */
    .event-title {
      font-size: 17px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.4;
      flex: 1;
    }

    /* Indicador de Cor lateral (Barra fina típica de apps de produtividade) */
    .event.border-red .event-title { color: var(--samsung-red); }
    .event.border-orange .event-title { color: var(--samsung-orange); }
    .event.border-blue .event-title { color: var(--samsung-blue); }
    .event.border-green .event-title { color: var(--samsung-green); }


    /* Header Right: Badge e Ícone */
    .header-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 12px;
      min-width: 100px; /* Espaço fixo para alinhamento */
    }

    /* === Badges (One UI Style: Sólido Pastel) === */
    .status-badge {
      font-size: 12px;
      padding: 6px 14px;
      border-radius: 50px; /* Pílula perfeita */
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border: none; /* Remove borda do estilo anterior */
    }

    .status-badge.badge-success {
      background-color: var(--bg-green-subtle);
      color: var(--samsung-green);
    }

    /* Badge Vermelho (Em Aberto) */
    .status-badge.badge-danger {
      background-color: var(--bg-red-subtle);
      color: var(--samsung-red);
    }
    
    /* Badge Amarelo/Laranja (Atenção/Validação) */
    .status-badge.badge-warning {
      background-color: var(--bg-orange-subtle);
      color: var(--samsung-orange);
    }

    /* Badge Manutenção */
    .status-badge.badge-maintenance {
      background-color: var(--bg-green-subtle); /* Manutenção é planejado = verde ou neutro */
      color: var(--samsung-green);
    }

    /* Badge Falha */
    .status-badge.badge-fail {
      background-color: var(--bg-red-subtle);
      color: var(--samsung-red);
    }

    .blink {
      animation: pulse-opacity 2s infinite;
    }

    @keyframes pulse-opacity {
      0% { opacity: 1; }
      50% { opacity: 0.6; }
      100% { opacity: 1; }
    }

    .toggle-text {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* === Timeline Area (Dentro do Card) === */
    .timeline-wrapper {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background-color: rgba(0,0,0,0.2); /* Levemente mais escuro que o card */
    }

    .event.expanded .timeline-wrapper {
      max-height: 1500px; /* Valor alto, mas controlado por transição */
    }
    
    /* 2. ADICIONA SCROLL VERTICAL AO DETALHE DO EVENTO */
    .timeline-wrapper table {
      display: block;
      /* Define uma altura máxima razoável para a tabela ter rolagem */
      max-height: 350px; 
      overflow-y: auto; /* Permite rolagem vertical */
    }
    
    .timeline-wrapper table::-webkit-scrollbar {
        width: 6px;
    }
    .timeline-wrapper table::-webkit-scrollbar-thumb {
        background-color: var(--samsung-blue);
        border-radius: 10px;
    }
    .timeline-wrapper table::-webkit-scrollbar-track {
        background: var(--surface-color);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      padding: 16px 24px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      color: #ccc;
    }

    th {
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 11px;
      letter-spacing: 1px;
      padding-top: 24px;
      position: sticky; /* Sticky header para a tabela */
      top: 0;
      background-color: rgba(0,0,0,0.5);
      z-index: 10;
    }
    
    /* Remove a borda inferior do sticky header */
    .timeline-wrapper table thead tr:first-child th {
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }


    td:first-child, td:nth-child(2) {
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-secondary);
      font-size: 12px;
    }

    tr:last-child td { border-bottom: none; padding-bottom: 24px; }

    .status-text-green { color: var(--samsung-green); font-weight: 700; }
    .status-text-red { color: var(--samsung-red); font-weight: 700; }
    .status-text-orange { color: var(--samsung-orange); font-weight: 700; }
    .status-text-blue { color: var(--samsung-blue); font-weight: 700; }

    /* === Rodapé ou Decoração === */
    .footer-spacer { 
      height: 100px; 
    }
    
    /* Novo estilo para o changelog */
    .changelog-area {
        padding: 20px 24px 40px;
        background-color: var(--surface-color);
        border-top: 1px solid rgba(255,255,255,0.05);
    }
    .changelog-area h3 {
        color: var(--samsung-blue);
        font-size: 18px;
        margin-top: 0;
        margin-bottom: 15px;
    }
    .changelog-area ul {
        list-style-type: none;
        padding: 0;
        margin: 0;
        font-size: 14px;
        color: var(--text-secondary);
    }
    .changelog-area li {
        margin-bottom: 8px;
        padding-left: 20px;
        position: relative;
    }
    .changelog-area li:before {
        content: '•';
        color: var(--samsung-orange);
        position: absolute;
        left: 0;
        font-size: 18px;
        line-height: 1;
    }


    @media (max-width: 768px) {
      .header-area { padding-top: 40px; }
      h1 { font-size: 28px; }
      .event-header { padding: 16px 20px; }
      .status-badge { font-size: 11px; padding: 4px 10px; }
    }
    
    /* 1. ESTILOS DO CARROSSEL (ÍNDICE DE EVENTOS) */
    .index-area {
      padding: 0 0 30px 0; /* Ajusta padding para que o carrossel comece na borda */
      margin-top: 20px;
    }

    .index-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 16px 15px 24px; /* Mantém o padding do título */
    }

    .index-grid {
      display: flex;
      overflow-x: auto; /* Habilita rolagem horizontal */
      padding: 0 16px 16px 16px; /* Padding inferior e lateral para cards e scrollbar */
      gap: 16px;
      scroll-snap-type: x mandatory; /* Efeito carrossel */
      -webkit-overflow-scrolling: touch;
    }
    
    /* Estilos da Scrollbar do Carrossel */
    .index-grid::-webkit-scrollbar {
        height: 6px;
    }
    .index-grid::-webkit-scrollbar-thumb {
        background-color: var(--samsung-blue);
        border-radius: 10px;
    }
    .index-grid::-webkit-scrollbar-track {
        background: var(--surface-color);
    }
    
    /* Impede quebras de coluna - mantendo o flex */
    .index-grid-wrapper {
        display: block; 
    }

    .index-day-card {
      /* Define a largura do card no carrossel */
      min-width: 85%; 
      max-width: 85%;
      
      /* Em telas maiores, podemos permitir 2 ou 3 cards */
      @media (min-width: 600px) {
        min-width: 45%; 
        max-width: 45%;
      }
      @media (min-width: 1024px) {
        min-width: 30%; 
        max-width: 30%;
      }
      
      background-color: var(--surface-color);
      border-radius: var(--border-radius-card);
      padding: 20px 24px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      scroll-snap-align: start; /* Alinha o card no início da rolagem */
    }

    /* ESTILO PARA O CONTADOR DE EVENTOS */
    .index-day-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--samsung-blue);
      margin: 0 0 15px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      padding-bottom: 10px;
      
      /* Configuração para o contador */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .event-count-badge {
        background-color: var(--samsung-blue);
        color: var(--text-primary);
        padding: 4px 10px;
        border-radius: 50px;
        font-size: 12px;
        font-weight: 900;
    }

    .index-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .index-list li {
      margin-bottom: 8px;
    }

    .index-link {
      display: block;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      padding: 8px 0;
      transition: color 0.2s;
      border-radius: 4px;
      cursor: pointer; /* Garante que pareça clicável */
    }

    .index-link:hover {
      text-decoration: underline;
    }

    /* Cores de Status no Índice */
    .index-link.status-green { color: var(--samsung-green); }
    .index-link.status-red { color: var(--samsung-red); }
    .index-link.status-orange { color: var(--samsung-orange); }
    .index-link.status-maintenance { color: var(--samsung-blue); } /* Manutenção usa azul para ser neutro/planejado */
  </style>
</head>
<body>

<div class="app-container">
  
  <div class="header-area">
    <div class="header-subtitle">War Room • Black Friday 2025</div>
    <h1>Diário de Bordo</h1>
    <!-- NOVO: Display para o timestamp de atualização -->
    <div id="updateTimestamp" class="update-timestamp"></div>
  </div>

  <div class="controls-area">
    <button id="filterButton" class="filter-button inactive" onclick="toggleFilter()">
        <span id="filterText">Visualizar </span>
        <span id="openCount" class="filter-count blink">0</span>
        <span id="filterLabel"> Incidentes Críticos Abertos</span>
    </button>
    <div id="openIncidentsContainer">
        <div id="openIncidentsList">
            </div>
    </div>
    
    <div class="select-wrapper">
      <!-- O SELECT FOI MANTIDO POR COERÊNCIA, MAS A NAVEGAÇÃO AGORA PRIORIZA O CARROSSEL -->
      <select id="dateSelect" onchange="showDate(this.value)">
        <option value="">Selecionar data...</option>
        <option value="2025-11-17">17 Novembro (Seg)</option>
        <option value="2025-11-18">18 Novembro (Ter)</option>
        <option value="2025-11-19">19 Novembro (Qua)</option>
        <!-- ADICIONADOS NOVOS DIAS -->
        <option value="2025-11-20">20 Novembro (Qui)</option>
        <option value="2025-11-21">21 Novembro (Sex)</option>
      </select>
    </div>
  </div>

  <div class="index-area">
    <h2 class="index-title">Índice de Eventos</h2>
    <div class="index-grid-wrapper">
        <div class="index-grid">
          
          <div class="index-day-card" data-day-id="2025-11-17">
            <h3 class="index-day-title">17 de Novembro (Seg) <span class="event-count-badge" data-count-day="2025-11-17">0</span></h3>
            <ul class="index-list">
              <!-- Adicionado evento-link para o JS scrollToEvent -->
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-17', 'event-17-1')">Pedidos Represados no Faturamento (Jund)</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-17', 'event-17-2')">Disco Insuficiente - Servidor Donatello (G:)</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-17', 'event-17-3')">Alto Consumo de Disco - PROD-WMS-INTEGRADOR (/)</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-17', 'event-17-4')">Instabilidade Link de Internet em Jundiaí</a></li>
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-17', 'event-17-5')">Espaço em Disco Criticamente Baixo - GLPI-PRD-APLICACAO [/data]</a></li>
              <li><a class="index-link status-orange" onclick="scrollToEvent('2025-11-17', 'event-17-6')">Site Sem Resposta (TRADE CREDIX WORKER)</a></li>
            </ul>
          </div>
          
          <div class="index-day-card" data-day-id="2025-11-18">
            <h3 class="index-day-title">18 de Novembro (Ter) <span class="event-count-badge" data-count-day="2025-11-18">0</span></h3>
            <ul class="index-list">
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-18', 'event-18-1')">Disco Criticamente Baixo - GLPI-PROXY-INVENTORY [/]</a></li>
              <li><a class="index-link status-maintenance" onclick="scrollToEvent('2025-11-18', 'event-18-2')">Disco Criticamente Baixo - SRV-PAOLLO [/]</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-18', 'event-18-3')">Falha em Rotinas e Backups - SRV-DONATELLO</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-18', 'event-18-4')">Agentes Zabbix Indisponíveis (MASACCIO/GIORGIONE)</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-18', 'event-18-5')">Alta Utilização de CPU - RBPSRVFS01</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-18', 'event-18-6')">Alta Utilização de CPU - WHISKEY</a></li>
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-18', 'event-18-7')">Queda de Link (Americanet) - FGT_JDI</a></li>
            </ul>
          </div>

          <div class="index-day-card" data-day-id="2025-11-19">
            <h3 class="index-day-title">19 de Novembro (Qua) <span class="event-count-badge" data-count-day="2025-11-19">0</span></h3>
            <ul class="index-list">
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-19', 'event-19-1')">Normalização Rotinas de Backup - SRV-DONATELLO</a></li>
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-19', 'event-19-2')">Expurgo de Base Pendente - GLPI-PRD-APLICACAO</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-19', 'event-19-3')">Normalização de Disco - GLPI-PROXY-INVENTORY</a></li>
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-19', 'event-19-4')">Indisponibilidade Pipe Core - Login (Erro 5XX)</a></li>
              <!-- NOVO EVENTO 19.5 -->
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-19', 'event-19-5')">ALERTA CRÍTICO: Vazamento de Credenciais (CERT.br)</a></li>
              <!-- NOVO EVENTO 19.6 -->
              <li><a class="index-link status-orange" onclick="scrollToEvent('2025-11-19', 'event-19-6')">ALERTA: Expiração de Certificado SSL (15 dias)</a></li>
              <!-- NOVO EVENTO 19.7 -->
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-19', 'event-19-7')">Queda de Acesso - alliedbrasil.com.br (LAN/VPN)</a></li>
              
            </ul>
          </div>
          
          <!-- NOVO DIA 20/11 -->
          <div class="index-day-card" data-day-id="2025-11-20">
            <h3 class="index-day-title">20 de Novembro (Qui) <span class="event-count-badge" data-count-day="2025-11-20">0</span></h3>
            <ul class="index-list">
              <li><a class="index-link status-red" onclick="scrollToEvent('2025-11-20', 'event-20-1')">RECORRÊNCIA: Falhas no Backup de Log (DONATELLO)</a></li>
            </ul>
          </div>

          <!-- NOVO DIA 21/11 -->
          <div class="index-day-card" data-day-id="2025-11-21">
            <h3 class="index-day-title">21 de Novembro (Sex) <span class="event-count-badge" data-count-day="2025-11-21">0</span></h3>
            <ul class="index-list">
              <li><a class="index-link status-green" onclick="scrollToEvent('2025-11-21', 'event-21-1')">Falha e Normalização no Backup Full (DONATELLO)</a></li>
              <li><a class="index-link status-maintenance" onclick="scrollToEvent('2025-11-21', 'event-21-2')">Falha na Varredura Completa (Full Scan) - Múltiplos Hosts</a></li>
              <li><a class="index-link status-orange" onclick="scrollToEvent('2025-11-21', 'event-21-3')">Alerta de Inatividade/Falha de Tópicos Kafka (LAG)</a></li>
            </ul>
          </div>
          
        </div>
    </div>
  </div>

  <div id="2025-11-17" class="content">
    <h2>Eventos de Segunda-feira</h2>

    <div id="event-17-1" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INCIDENTE #2511170003: Represamento no Faturamento (Jund)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:31:00</td><td>Gleice</td><td>Acionamento inicial: Faturamento paralisado. (Chamado #2511170003)</td></tr>
          <tr><td>08:37:00</td><td>Pablo</td><td>Verificação: Robôs do Jundiaí estão OK. Identificado pedido das 08:10 represado na fila de Separação. O pedido seguiu o fluxo.</td></tr>
          <tr><td>08:40:00</td><td>Sistema</td><td><span class="status-text-green">RESOLVIDO</span> Fluxo de faturamento normalizado. (Causa raiz: Represamento pontual e autossolucionado).</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-2" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Disco Insuficiente – SRV-DONATELLO (G:)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:09:00</td><td>Monitoramento</td><td>Alerta de espaço em disco (G:). Disponível: 573.1 GB.</td></tr>
          <tr><td>08:11:00</td><td>Gabriel</td><td>Hipótese: Falha na exclusão do backup. Acionado time de DB.</td></tr>
          <tr><td>10:03:00</td><td>G. Soares</td><td>Ação: Solicitado ajuste na trigger para 500 GB (readequação do threshold).</td></tr>
          <tr><td>10:20:00</td><td>G. Soares</td><td>Movendo backup full + checkdb (G: -> E:). Será deletado após mover para o S3.</td></tr>
          <tr><td>11:16:00</td><td>Monitor</td><td><span class="status-text-green">NORMALIZADO</span> Disco retornou para 42% de uso.</td></tr>
          <tr><td>18:15:00</td><td>Fabio (Teams)</td><td><span class="status-text-green">CAUSA RAIZ ENCONTRADA</span> Walmir alterou o horário do backup de Image Level da Equinix (de 02:00h) para evitar conflito com o backup do banco de dados, que causava instabilidade no cluster.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-3" class="event border-blue" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Alto Consumo de Disco – PROD-WMS-INTEGRADOR (/)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:54:00</td><td>Pablo</td><td>Acionamento: Alerta filesystem root (/). Utilização: 97%.</td></tr>
          <tr><td>08:46:00</td><td>Murilo</td><td>Time de Suporte acionado para limpeza de logs.</td></tr>
          <tr><td>09:44:00</td><td>Murilo</td><td><span class="status-text-green">RESOLVIDO</span> Problema de espaço em disco corrigido (Limpeza de logs/temps).</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-4" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Instabilidade Link Jundiaí</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>16:25:00</td><td>Elison</td><td>Identificada latência alta/perda de pacote em Jundiaí.</td></tr>
          <tr><td>16:28:00</td><td>Matheus - JDI</td><td>Queda de internet de **aproximadamente 3 minutos** há pouco. Serviço **já foi normalizado**. Oscilação diária padrão.</td></tr>
          <tr><td>16:30:00</td><td>Elison</td><td>Verificado que o sistema estava normal.</td></tr>
        </table>
      </div>
    </div>
    
    <div id="event-17-5" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Espaço em Disco - GLPI-PRD-APLICACAO [/data]</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>17/11 12:10</td><td>Elison Arley</td><td>Questiona Fábio José sobre o retorno do GLPI. Uso de disco em 95.7% (156.4GB total).</td></tr>
          <tr><td>17/11 12:10</td><td>Sistema (Zabbix)</td><td>PROBLEM: FS [/data] Critically low (used > 90%).</td></tr>
          <tr><td>18/11 12:46</td><td>Fábio Jose</td><td><span class="status-text-red">URGENTE</span> Necessidade de RDM Emergencial para expurgo de base (uso > 95%). Cobra mapeamento dos caminhos ao Gabriel Ribeiro. Kaue Silva adicionado.</td></tr>
          <tr><td>18/11 16:12</td><td>Fábio Jose</td><td>Cobrança: Gabriel Ribeiro Viana Aguiar algum retorno?</td></tr>
          <tr><td>18/11 18:16</td><td>Gabriel Ribeiro</td><td>Informou a relação de grupos para expurgo. Fábio informou que precisa dos *patchs* ou do script via banco.</td></tr>
          <tr><td>18/11 18:49</td><td>Fellipe Soares (DBA)</td><td>Informou que irá precisar montar o script para todas as pastas citadas.</td></tr>
          <tr><td>18/11 19:15</td><td>Gabriel Ribeiro</td><td>Reforçou a importância de manter os arquivos expurgados em outra "Maquina".</td></tr>
          <!-- NOVAS INFORMAÇÕES DO DIA 19/11 (ATUALIZADO) -->
          <tr><td>19/11 13:29</td><td>Magali Lucena</td><td>Cobrou posição de conclusão e se Fellipe irá prosseguir com o script.</td></tr>
          <tr><td>19/11 14:44</td><td>Fellipe Soares</td><td>Enviou lista de acordo com grupos e datas de expurgo solicitadas.</td></tr>
          <tr><td>19/11 14:56</td><td>Fabio Santos</td><td>Solicitou alinhamento para definição das próximas etapas.</td></tr>
          <tr><td>19/11 15:31</td><td>Fabio</td><td><span class="status-text-red">EXPURGO AGENDADO</span> Alinhado o Expurgo para hoje **após as 20:00**. Informado que pode haver lentidão e indisponibilidade.</td></tr>
          <tr><td>19/11 17:11</td><td>Gabriel</td><td><span class="status-text-orange">COMUNICADO</span> Informado que o comunicado de manutenção no GLPI (20:00h até o fechamento das lojas) foi realizado. Sistema pode ter lentidão/instabilidade, mas não ficará indisponível.</td></tr>
          <tr><td>19/11 20:37</td><td>Elison Arley</td><td><span class="status-text-green">RESOLVIDO</span>: Verificado que a partição está com **32,99%** de uso de disco no momento, após as ações tomadas.</td></tr>
          <tr><td>19/11 21:16</td><td>Gabriel Ribeiro</td><td><span class="status-text-blue">NOVO FLUXO</span>: Chamados seguem acessíveis. Anexos fora da data de corte do expurgo retornarão "arquivo não encontrado". Área solicitante deve indicar o arquivo para disponibilização.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-6" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Site Sem Resposta (TRADE CREDIX WORKER CONSUMER DLQ)</div>
        <div class="header-right">
          <span class="status-badge badge-warning">Ignorado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>17/11 15:49</td><td>Sistema (Zabbix)</td><td>PROBLEM: WORKER CONSUMER DLQ - site sem responder há mais de 5 min. Status: *UNKNOWN*. Duração: 1d 1h 2m.</td></tr>
          <tr><td>18/11 16:00:00</td><td>Callel</td><td><span class="status-text-orange">IGNORADO</span> Devido ao *freezing* (período de congelamento de mudanças/serviços), o problema será tratado após a Black Friday.</td></tr>
        </table>
      </div>
    </div>
  </div>

  <div id="2025-11-18" class="content">
    <h2>Eventos de Terça-feira</h2>

    <div id="event-18-1" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <!-- CRITICAL: Disco Criticamente Baixo - GLPI-PROXY-INVENTORY [/] -->
        <div class="event-title">CRITICAL: Disco Criticamente Baixo - GLPI-PROXY-INVENTORY [/]</div>
        <div class="header-right">
          <!-- O status agora é Normalizado -->
          <span class="status-badge badge-success">Normalizado</span> 
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:00:27</td><td>L. Gomes</td><td>PROBLEM: FS [/] Critically low (used > 90%, total 7.6GB). Atual: 90.9%</td></tr>
          <tr><td>07:47:00</td><td>L. Gomes</td><td>Informado via grupo NOC sobre o alerta de disco crítico.</td></tr>
          <tr><td>10:21:00</td><td>Operação</td><td>EM ABERTO: Aguardando ação corretiva.</td></tr>
          <tr><td>19/11 14:19</td><td>E. Arley</td><td><span class="status-text-green">NORMALIZADO</span>: Servidor voltou para estado normal (88%). (Referência ao evento 19.3)</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-2" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Disco Criticamente Baixo - SRV-PAOLLO [/]</div>
        <div class="header-right">
          <span class="status-badge badge-maintenance">Manutenção</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:42:43</td><td>Sistema (Zabbix)</td><td>PROBLEM: FS [/] Critically low (used > 90%, total 44.0GB). Atual: 92.6%</td></tr>
          <tr><td>10:49:00</td><td>Operação</td><td>Status: ainda em aberto. Sem resposta / ação corretiva registrada.</td></tr>
          <tr><td>14:56:00</td><td>Daily Teams</td><td>Kaue informou que está realizando manutenção no servidor e ficará indisponível.</td></tr>
          <tr><td>16:32:00</td><td>Kaue Silva</td><td>Solicitou que o Paollo seja deixado em manutenção por 30 dias para resolver a questão comercial dos discos.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-3" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">FALHA: Rotinas de Backup - SRV-DONATELLO</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:39:00</td><td>L. Gomes</td><td>Reportado falha em jobs SQL no Donatello.</td></tr>
          <tr><td>08:14:00</td><td>G. Soares</td><td>Diagnóstico: Disco G: com alta latência para escrita. Backup rodando há 14h. Sugestão: Cancelar backup e acionar Equinix.</td></tr>
          <tr><td>08:20:00</td><td>L. Gomes</td><td>Escalado para o NOC. Zabbix reportou falhas nos jobs: DBA_Rotinas Administrativas (Backup Log, Truncate Log File) e Log backup older than 8h (várias DBs).</td></tr>
          <tr><td>12:07:00</td><td>G. Soares (Devops)</td><td>Cancelou backup travado para ação da Equinix.</td></tr>
          <tr><td>12:58:00</td><td>F. Jose (Devops)</td><td>Equinix acionada. Agenda solicitada na parte da tarde com time de DB.</td></tr>
          <tr><td>13:08:00</td><td>F. Jose (Devops)</td><td><span class="status-text-orange">EQUINIX UPDATE</span>: "Ocorreu uma falha de rede na estrutura do backup... foi efetuada correção."</td></tr>
          <tr><td>13:08:00</td><td>E. Arley</td><td>Status: Aguardando validação.</td></tr>
          <tr><td>18:15:00</td><td>Fabio via Teams</td><td>Walmir alterou o horário do backup de image level (de 02:00h) para evitar conflito com o backup do banco de dados, prevenindo instabilidade no cluster.</td></tr>
          <tr><td>19/11 10:00</td><td>E. Arley</td><td><span class="status-text-orange">PENDENTE</span> Cobrar atualização do time de banco se o backup foi realizado ou não.</td></tr>
          <tr><td>19/11 10:28</td><td>E. Arley</td><td><span class="status-text-green">VALIDADO</span> Verificado que as rotinas foram executadas com sucesso, confirmado pelo Gabriel Soares.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-4" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Agentes Zabbix Indisponíveis (MASACCIO e GIORGIONE)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>14/11 10:02</td><td>Sistema (Zabbix)</td><td>PROBLEM: MASACCIO - Zabbix agent is not available (duração: 4d 28m).</td></tr>
          <tr><td>13/11 17:02</td><td>Sistema (Zabbix)</td><td>PROBLEM: GIORGIONE - Zabbix agent is not available (duração: 4d 17h 29m).</td></tr>
          <tr><td>10:34:28</td><td>Operação/NOC</td><td>Solicitado que os servidores fiquem em modo de manutenção no Zabbix para investigação.</td></tr>
          <tr><td>10:35:00</td><td>Kaue Silva</td><td>Solicitou a desativação e remoção posterior da monitoria.</td></tr>
          <tr><td>10:37:00</td><td>Operação/NOC</td><td>Monitoração desativada a pedido do Kaue Silva.</td></tr>
          <tr><td>10:38:00</td><td>E. Arley</td><td><span class="status-text-green">RESOLVIDO</span> Servidores Desativados.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-5" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">ALERTA: Alta Utilização de CPU - RBPSRVFS01</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:48:20</td><td>Sistema (Zabbix)</td><td>PROBLEM: High CPU utilization (> 90% por 5m). Atual: 99.97%.</td></tr>
          <tr><td>11:00:00</td><td>E. Arley</td><td>Informado no grupo do NOC.</td></tr>
          <tr><td>11:01:00</td><td>M. Rodrigues</td><td>Causa: Scan manual do Windows Defender em andamento (Ricardo Henrique).</td></tr>
          <tr><td>11:05:00</td><td>Fabio Santos</td><td><span class="status-text-green">NORMALIZADO</span> Scan foi pausado e CPU normalizada. Alinhamento feito com Ricardo para comunicação prévia de atividades.</td></tr>
          <tr><td>19/11 16:09</td><td>E. Arley</td><td><span class="status-text-red">RECORRÊNCIA</span>: Servidor voltou a ficar com CPU > 90%. Kaue acionou Equinix para verificar consumo de CLBackup.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-6" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">ALERTA: Alta Utilização de CPU - WHISKEY</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:11:38</td><td>Sistema (Zabbix)</td><td>PROBLEM: High CPU utilization (> 90% por 5m). Atual: 100%.</td></tr>
          <tr><td>11:00:00</td><td>E. Arley</td><td>Informado no grupo do NOC.</td></tr>
          <tr><td>11:01:00</td><td>M. Rodrigues</td><td>Causa: Scan manual do Windows Defender em andamento (Ricardo Henrique).</td></tr>
          <tr><td>11:05:00</td><td>Fabio Santos</td><td>Scan supostamente pausado. Alinhamento realizado.</td></tr>
          <tr><td>13:06:00</td><td>E. Arley</td><td>CPU ainda em 100% mesmo após o suposto "stop" do antivírus.</td></tr>
          <tr><td>14:30:00</td><td>Murillo</td><td>Verificado em reunião com Ricardo que o Defender não havia sido parado.</td></tr>
          <tr><td>15:20:00</td><td>E. Arley</td><td><span class="status-text-green">NORMALIZADO</span> Uso de CPU está normalizado.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-7" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Queda de Link (Americanet) - FGT_JDI</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>14:26:32</td><td>E. Arley (NOC)</td><td>PROBLEM: Queda no Link da Americanet em Jundiaí.</td></tr>
          <tr><td>14:29:00</td><td>Matheus (JDI)</td><td>Evidência enviada.</td></tr>
          <tr><td>15:11:00</td><td>Matheus (JDI)</td><td><span class="status-text-red">UPDATE PROVEDOR</span>: Incidente crítico no backbone principal. Indisponibilidade total. Previsão: 8 horas. Chamado: #2511188538.</td></tr>
          <tr><td>16:59:00</td><td>Matheus (JDI)</td><td>Reportou indisponibilidade no TS-JUND load balancer.</td></tr>
          <tr><td>17:20:00</td><td>E. Arley (NOC)</td><td>Acesso ao TS-JUND restabelecido, internet operando por apenas um link.</td></tr>
          <tr><td>17:21:00</td><td>E. Arley (NOC)</td><td>Link da operadora Americanet Continua fora.</td></tr>
          <tr><td>17:30:00</td><td>Matheus (JDI)</td><td><span class="status-text-green">NORMALIZADO</span> Link da operadora normalizado.</td></tr>
        </table>
      </div>
    </div>

  </div>

  <div id="2025-11-19" class="content">
    <h2>Eventos de Quarta-feira</h2>
    
    <!-- EVENTO 19.1: NORMALIZAÇÃO DE BACKUP (Validado) -->
    <div id="event-19-1" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Normalização Rotinas de Backup - SRV-DONATELLO</div>
        <div class="header-right">
          <span class="status-badge badge-success">Validado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:00</td><td>E. Arley</td><td>Cobrança de atualização ao time de banco sobre a execução do backup (Ação Pendente do dia anterior).</td></tr>
          <tr><td>10:28</td><td>E. Arley</td><td><span class="status-text-green">VALIDADO</span> Verificado que as rotinas foram executadas com sucesso. Confirmado pelo Gabriel Soares (Banco) que ocorreu dentro da janela prevista.</td></tr>
        </table>
      </div>
    </div>
    
    <!-- NOVO EVENTO 19.2: GLPI-PRD-APLICACAO (Expurgo Pendente) - AGORA RESOLVIDO -->
    <div id="event-19-2" class="event border-green" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">INFO: Expurgo de Base Concluído - GLPI-PRD-APLICACAO</div>
            <div class="header-right">
                <span class="status-badge badge-success">Resolvido</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <!-- Referência ao incidente do dia 17, com follow-up no dia 19 -->
                <tr><td>17/11 12:10</td><td>INC. ORIGEM</td><td>O evento original (17.5) acionou a necessidade de expurgo urgente (uso de disco 95.7%).</td></tr>
                <tr><td>19/11 13:29</td><td>Magali Lucena</td><td>Cobrou uma posição de data de conclusão e se Fellipe irá prosseguir com o script.</td></tr>
                <tr><td>19/11 14:44</td><td>Fellipe Soares</td><td>Enviou a lista de acordo com os grupos e datas de expurgo solicitadas.</td></tr>
                <tr><td>19/11 14:56</td><td>Fabio Santos</td><td>Solicitou um alinhamento para definição das próximas etapas.</td></tr>
                <tr><td>19/11 15:31</td><td>Fabio</td><td><span class="status-text-red">EXPURGO AGENDADO</span> Alinhado o Expurgo para hoje **após as 20:00**. Informado que pode haver lentidão e indisponibilidade.</td></tr>
                <tr><td>19/11 17:11</td><td>Gabriel</td><td><span class="status-text-orange">COMUNICADO</span> Informado que o comunicado de manutenção no GLPI (20:00h até o fechamento das lojas) foi realizado. Sistema pode ter lentidão/instabilidade, mas não ficará indisponível.</td></tr>
                <tr><td>19/11 20:37</td><td>E. Arley</td><td><span class="status-text-green">RESOLVIDO</span>: Verificado que a partição está com **32,99%** de uso de disco no momento, após o expurgo.</td></tr>
                <tr><td>19/11 21:16</td><td>Gabriel Ribeiro</td><td><span class="status-text-blue">NOVO FLUXO</span>: Chamados seguem acessíveis. Anexos fora da data de corte do expurgo retornarão "arquivo não encontrado". Área solicitante deve indicar o arquivo para disponibilização.</td></tr>
            </table>
        </div>
    </div>
    
    <!-- NOVO EVENTO 19.3: NORMALIZAÇÃO DE DISCO - GLPI-PROXY-INVENTORY -->
    <div id="event-19-3" class="event border-green" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">INFO: Normalização de Disco - GLPI-PROXY-INVENTORY [/]</div>
            <div class="header-right">
                <span class="status-badge badge-success">Normalizado</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <!-- Referência ao incidente do dia 18, com normalização no dia 19 -->
                <tr><td>18/11 07:00</td><td>INC. ORIGEM</td><td>O evento original (18.1) acionou o problema de disco cheio (90.9%).</td></tr>
                <tr><td>19/11 14:19</td><td>Elison Arley</td><td><span class="status-text-green">NORMALIZADO</span> Servidor voltou para o estado normal (88%), que é a média dos últimos 30 dias.</td></tr>
            </table>
        </div>
    </div>
    
    <!-- EVENTO 19.4: INDISPONIBILIDADE PIPE CORE (Renumerado) -->
    <div id="event-19-4" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Indisponibilidade Pipe Core - Login (Erro 5XX)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:30</td><td>Operação / NOC</td><td>PROBLEM: Identificado indisponibilidade no Pipe Core - Login (Erros 5XX detectados via Instana).</td></tr>
          <tr><td>10:46</td><td>Operação / NOC</td><td>Reportado para Rangel (privado), que solicitou formalização no grupo DevOps.</td></tr>
          <tr><td>10:52</td><td>Rangel (DevOps)</td><td>Confirmou que iniciou a análise e troubleshooting do ambiente.</td></tr>
          <tr><td>10:55</td><td>Rangel (DevOps)</td><td>Atuação técnica iniciada para mitigação do problema.</td></tr>
          <tr><td>11:11</td><td>Lucas Quirino</td><td><span class="status-text-green">RESOLVIDO</span> Sistemas Normalizados.</td></tr>
        </table>
      </div>
    </div>

    <!-- EVENTO 19.5: ALERTA DE SEGURANÇA CRÍTICO -->
    <div id="event-19-5" class="event border-red" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">SECURITY ALERT: Vazamento de Credenciais (CERT.br)</div>
            <div class="header-right">
                <span class="status-badge badge-danger blink">IR em Andamento</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <!-- Ajuste Ator: Monitoramento/Asper -->
                <tr><td>12:27</td><td>Monitoramento / Asper</td><td><span class="status-text-red">SECURITY ALERT</span> Recebimento e acknowledge de alerta crítico via CERT.br sobre suspeita de vazamento de credenciais.</td></tr>
                <!-- Ajuste Ator: Monitoramento/Asper -->
                <tr><td>12:27</td><td>Monitoramento / Asper</td><td>Initial Triage: Mapeamento preliminar de Domínios/Serviços Afetados (e.g., servicedesk, alliedconectados). Alerta é preventivo.</td></tr>
                <!-- Ajuste Ator: Asper -->
                <tr><td>15:50</td><td>Asper</td><td><span class="status-text-red">ESCALATION</span> Acionamento imediato do time de Security/CISO e DevOps/Infra. Recomendação de **rotação imediata de credenciais** e auditoria de acessos.</td></tr>
                <tr><td>15:50</td><td>Security / CISO</td><td>Mitigation Plan WIP (IR): Início da investigação forense (IR). Ações: 1. Cruzamento de logs e hash das máquinas infectadas. 2. Forcing Password Reset para e-mails corporativos expostos.</td></tr>
                <tr><td>15:50</td><td>Infra / DevOps</td><td>Hardening Implementation: Início da revisão da Política de Firewall de Aplicação (WAF) e Estratégia de Segmentação de Rede nas VPCs.</td></tr>
                <!-- Ajuste Ator: Asper / CISO -->
                <tr><td>13:30</td><td>Asper / CISO</td><td>Post-Incident Analysis: Avaliação final de risco e compliance pela consultoria Asper. (Hora do PDF: 13:30)</td></tr>
                <tr><td>21/11 10:47</td><td>E. Arley</td><td><span class="status-text-orange">PENDENTE</span> Solicitado ao Vinicius Avelino um retorno da analise da Asper (Follow-up do dia 21/11).</td></tr>
            </table>
        </div>
    </div>
    
    <!-- NOVO EVENTO 19.6: EXPIRAÇÃO SSL (EXTRAÍDO DO 19.5) -->
    <div id="event-19-6" class="event border-orange" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">ALERTA: Expiração de Certificado SSL (15 dias)</div>
            <div class="header-right">
                <span class="status-badge badge-warning">Acompanhamento</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <tr><td>15:17</td><td>E. Arley (NOC)</td><td>ALERT: Certificado SSL do domínio **allieddpp.com.br expira em 15 dias**. <span class="status-text-orange">PRIORIDADE ALTA</span>. Necessário iniciar workflow de renovação.</td></tr>
                <tr><td>15:17</td><td>Você</td><td>Workflow de renovação acionado para o time de Cloud/Infra.</td></tr>
            </table>
        </div>
    </div>
    
    <!-- NOVO EVENTO 19.7: Queda de Acesso - alliedbrasil.com.br (LAN/VPN) -->
    <div id="event-19-7" class="event border-red" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">CRITICAL: Queda de Acesso - alliedbrasil.com.br (Rede Interna/VPN)</div>
            <div class="header-right">
                <span class="status-badge badge-success">Normalizado</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <tr><td>17:32</td><td>Luiz Galante (NOC)</td><td>PROBLEM (Disponibilidade): Confirmação de que o asset alliedbrasil.com.br está inacessível para Rede Interna. Descartada alteração recente no Azion (CDN/WAF).</td></tr>
                <tr><td>17:32</td><td>Lucas Quirino (NOC)</td><td>Status Quo: Não houve *change* no *edge* ou *backend* do asset nos últimos 30 minutos. Hipótese de erro em regra de CDN é baixa.</td></tr>
                <tr><td>17:34</td><td>E. Arley (NOC)</td><td>Scope Defined: Acesso normalizado via Internet/4G. Falha totalmente restrita ao Egress corporativo (Rede Interna e VPN). O problema é Rede/Infraestrutura e não Aplicação.</td></tr>
                <tr><td>17:40</td><td>Monitoramento (Você)</td><td><span class="status-text-red">ESCALATION</span>: Acionamento do time de Cloud via [Teams] para investigação *on-premise*. Requerido *traceroute* e validação de DNS interno/externo. Ação imediata: Auditar ACLs/Firewalls de Borda.</td></tr>
                <tr><td>18:09</td><td>Luiz Galante (Cloud)</td><td><span class="status-text-green">RESOLVIDO</span>: Realizada a alteração do IP do DNS. Acesso normalizado. Pode ser necessário *flushdns* ou reconexão da VPN em alguns casos.</td></tr>
            </table>
        </div>
    </div>
    
  </div>
  
  <!-- NOVO DIA 20/11 -->
  <div id="2025-11-20" class="content">
    <h2>Eventos de Quinta-feira</h2>
    
    <!-- EVENTO 20.1: RECORRÊNCIA DE FALHAS NO BACKUP DE LOG -->
    <div id="event-20-1" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Recorrência de Falhas no Backup de Log (DONATELLO)</div>
        <div class="header-right">
          <span class="status-badge badge-danger blink">Em Aberto</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>22:00:28 (Ontem)</td><td>Sistema</td><td>PROBLEM: Falha na execução do Job 'DBA_Rotinas Administrativas - (Backup Log)' e do Job 'Truncate Log File (Jundsoft)'. Duração da falha: 10h 13m 35s.</td></tr>
          <tr><td>17:03 (Ontem)</td><td>Pablo de A. Cruz</td><td>Comunicação: Alertas sobre Logs com mais de 8h (Duração: 13h 10m) e as falhas dos Jobs (Duração: 19h 2s) foram encaminhados. **Solicitada a desconsideração destes alertas.**</td></tr>
          <tr><td>03:50:30 (Hoje)</td><td>Sistema</td><td><span class="status-text-red">PROBLEMA RECORRENTE</span>: Múltiplos alertas de "Log backup older than 8h" em cinco bases de dados. Duração: 4h 23m 33s e crescendo.</td></tr>
        </table>
      </div>
    </div>
    
  </div>
  
  <!-- NOVO DIA 21/11 -->
  <div id="2025-11-21" class="content">
    <h2>Eventos de Sexta-feira</h2>
    
    <!-- EVENTO 21.1: FALHA NO BACKUP FULL -->
    <div id="event-21-1" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">FALHA: Falha e Normalização no Backup Full (DONATELLO)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:24</td><td>L. Gomes</td><td>Acionamento inicial: Alerta de baixo espaço em disco para Backup Full no host DONATELLO (FS BACKUP 5 SPACE REMAIN < 100GB).</td></tr>
          <tr><td>07:24</td><td>L. Gomes</td><td>Análise Detalhada: Verificação da Job History. Identificado que o backup do dia 19/11 excedeu o tempo de vida (> 20 horas), impedindo a exclusão automática e saturando o disco.</td></tr>
          <tr><td>08:18</td><td>Gabriel Soares</td><td><span class="status-text-green">RESOLVIDO/CONFIRMAÇÃO</span>: O backup Full da rotina administrativa de hoje (20/11) foi executado com sucesso. O alerta de espaço foi normalizado.</td></tr>
        </table>
      </div>
    </div>
    
    <!-- EVENTO 21.2: FALHA NA VARREDURA COMPLETA -->
    <div id="event-21-2" class="event border-blue" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Falha na Varredura Completa (Full Scan) - Múltiplos Hosts</div>
        <div class="header-right">
          <span class="status-badge badge-maintenance">Alerta Preventivo</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Host</th><th>Status / Detalhes</th></tr>
          <tr><td>19/11 20:57</td><td>SANDRO</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 12h 55m.</td></tr>
          <tr><td>19/11 20:57</td><td>BOSCH</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 12h 55m.</td></tr>
          <tr><td>19/11 20:31</td><td>CEZANNE</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>19/11 20:31</td><td>DONATELLO</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>19/11 20:31</td><td>ANGELICO</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>19/11 20:31</td><td>BACON</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>19/11 20:31</td><td>WOLFGANG</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>19/11 20:31</td><td>RENOIR</td><td>PROBLEM - Operational Data: 7 days. Duration: 1d 13h 22m.</td></tr>
          <tr><td>20/11 12:03</td><td>E. Arley</td><td>Informado no privado ao Ricardo Henrique para que verifique os alertas acima.</td></tr>
        </table>
      </div>
    </div>
    
    <!-- EVENTO 21.3: NOVO INCIDENTE KAFKA -->
    <div id="event-21-3" class="event border-orange" onclick="toggleEvent(this)">
        <div class="event-header">
            <div class="event-title">ALERTA: Alerta de Inatividade/Falha de Tópicos Kafka (LAG / SA UPDATE ORDERS)</div>
            <div class="header-right">
                <span class="status-badge badge-warning">Acompanhamento</span>
                <span class="toggle-text">Detalhes ▼</span>
            </div>
        </div>
        <div class="timeline-wrapper">
            <table>
                <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
                <tr><td>11:02</td><td>Rangel, Roger, Wilson</td><td>Acionamento inicial: Solicitação de verificação do alerta de Kafka Tópicos LAG e SA UPDATE ORDERS (Inativo ou com falha - Severity: Warning/Problem).</td></tr>
                <tr><td>11:11</td><td>Rangel D. de Almeida</td><td>Investigação: Questiona a origem dos alertas e envia screenshot de tópicos ativos, sugerindo que os lags estão OK.</td></tr>
                <tr><td>11:12</td><td>Rangel D. de Almeida</td><td>Confirmação: "Oi Rangel, boa tarde. Alarmaram novamente." / "lags estao ok" (referindo-se à verificação de lag em tempo real no monitoramento).</td></tr>
                <tr><td>15:14</td><td>Rangel D. de Almeida</td><td><span class="status-text-orange">AÇÃO MITIGADORA</span>: "vou ajustar os parâmetros aqui das chamadas, como temos alguns picos durante o dia, o lag em certos momentos é normal".</td></tr>
            </table>
        </div>
    </div>
    
  </div>
  
  
  <!-- NOVO: Seção de Últimas Mudanças (Changelog) -->
  <div class="changelog-area">
    <h3>Últimas Mudanças no Diário</h3>
    <ul>
      <li>[21/11 15:30] **Nova Consolidação (21/11):** Adicionado novo incidente Kafka (21.3). Atualizado follow-up de Full Scan (21.2) com acionamento do Ricardo Henrique.</li>
      <li>[21/11 10:20] **Incidente GLPI RESOLVIDO:** Consolidada a conclusão do expurgo GLPI-PRD-APLICACAO (17.5/19.2) com uso de disco em 32.99% e novo fluxo de anexos.</li>
      <li>[21/11 10:05] **Nova Consolidação (20/11 - 21/11):** Adicionados eventos de Recorrência de Falha de Log (20.1), Falha/Normalização de Backup Full (21.1) e Falha de Full Scan em 8 Hosts (21.2).</li>
    </ul>
  </div>

  <div class="footer-spacer"></div>
</div>

<script>
  let isFilterActive = false;

  // NOVA FUNÇÃO: Atualiza os contadores de eventos no carrossel do índice
  function updateEventCounts() {
    const dayContents = document.querySelectorAll('.content');
    
    dayContents.forEach(dayContent => {
        const dateId = dayContent.id;
        // Conta quantos eventos estão dentro deste bloco de conteúdo
        const eventCount = dayContent.querySelectorAll('.event').length;
        
        // Encontra o badge correspondente no carrossel pelo atributo de dados
        const countBadge = document.querySelector(`.event-count-badge[data-count-day="${dateId}"]`);
        
        if (countBadge) {
            countBadge.textContent = eventCount;
        }
    });
  }


  // Função central para rolar para um evento específico
  function scrollToEvent(dateId, eventId) {
    const dateSelect = document.getElementById('dateSelect');
    
    // 1. Garante que o dia correto esteja ativo (mesmo que já esteja)
    dateSelect.value = dateId;
    showDate(dateId);
    
    // 2. Espera a transição de showDate e rola para o evento
    setTimeout(() => {
        const eventElement = document.getElementById(eventId);
        if (eventElement) {
            // Rola para o evento
            eventElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Garante que ele esteja expandido e dá um feedback visual (pisca)
            if (!eventElement.classList.contains('expanded')) {
                eventElement.classList.add('expanded');
            }
            
            // Efeito de destaque
            eventElement.style.transition = 'background-color 0.1s';
            const originalColor = eventElement.style.backgroundColor;
            setTimeout(() => eventElement.style.backgroundColor = 'var(--surface-color-highlight)', 100);
            setTimeout(() => eventElement.style.backgroundColor = originalColor || 'var(--surface-color)', 500);
        }
    }, 400); // Tempo de espera para garantir que o 'content' esteja visível
  }

  // Função para renderizar os incidentes abertos na lista global
  function renderOpenIncidents() {
    const openIncidentsList = document.getElementById('openIncidentsList');
    const openCountSpan = document.getElementById('openCount');
    
    // Limpa a lista antes de renderizar
    openIncidentsList.innerHTML = '';

    // Encontra todos os eventos com o status "Em Aberto"
    const openEvents = document.querySelectorAll('.event .badge-danger.blink');
    
    openCountSpan.textContent = openEvents.length;

    if (openEvents.length > 0) {
        openEvents.forEach(badge => {
            const eventCard = badge.closest('.event');
            const clone = eventCard.cloneNode(true);
            
            // 1. Adiciona a classe 'open-incident-clone' para estilização de filtro
            clone.classList.add('open-incident-clone');
            
            // 2. Garante que o card clonado esteja EXPANDIDO para exibir os detalhes
            clone.classList.add('expanded');
            
            // 3. Atualiza o texto de toggle (Detalhes) para a lista de abertos
            const toggleText = clone.querySelector('.toggle-text');
            if (toggleText) {
                toggleText.textContent = 'Ver Card Original ↗';
            }
            // Remove o onclick do clone para não colapsar na lista de abertos
            clone.onclick = null;
            
            // Adiciona um listener que chama a nova função scrollToEvent
            clone.addEventListener('click', () => {
                const dateId = eventCard.parentElement.id;
                const eventId = eventCard.id;
                // Busca o ID do evento original na lista de conteúdo
                const originalEvent = document.getElementById(eventId);
                const actualEventId = originalEvent ? originalEvent.id : eventId; // Usa o ID do clone se o original não for encontrado (segurança)
                scrollToEvent(dateId, actualEventId);
            });
            
            openIncidentsList.appendChild(clone);
        });
        document.getElementById('filterButton').classList.remove('inactive');
    } else {
        openCountSpan.classList.remove('blink');
    }
  }

  // Função principal de filtro (agora apenas gerencia a exibição da lista global)
  function toggleFilter() {
    const listContainer = document.getElementById('openIncidentsList');
    
    // Alterna o estado do filtro (expande/contrai a lista)
    isFilterActive = !isFilterActive;
    listContainer.classList.toggle('expanded', isFilterActive);
    
    const filterButton = document.getElementById('filterButton');
    filterButton.classList.toggle('active-filter', isFilterActive);
    
    if (isFilterActive) {
      filterButton.querySelector('#filterText').textContent = 'Ocultar ';
    } else {
      filterButton.querySelector('#filterText').textContent = 'Visualizar ';
    }
  }
  
  // Função para exibir o conteúdo da data selecionada
  function showDate(value) {
    // Garante que o filtro esteja fechado ao mudar a data
    if (isFilterActive) {
        toggleFilter();
    }
    
    const contents = document.querySelectorAll('.content');
    contents.forEach(el => el.classList.remove('active'));
    
    if (value) {
      setTimeout(() => {
        document.getElementById(value).classList.add('active');
        // A contagem não precisa ser atualizada aqui, pois é global
      }, 50);
    }
  }
  
  function toggleEvent(element) {
    element.classList.toggle('expanded');
  }

  // Função para exibir o timestamp
  function displayUpdateTimestamp() {
    // Obtém a data e hora atual no formato brasileiro (DD/MM/YYYY HH:MM)
    const now = new Date();
    // Definindo a data de consolidação para o momento atual (21/11/2025)
    const fixedDate = new Date(2025, 10, 21, 15, 30); // 15:30 BRT
    
    const formattedDate = fixedDate.toLocaleDateString('pt-BR', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
    });
    const formattedTime = fixedDate.toLocaleTimeString('pt-BR', {
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
    });
    
    const timestampElement = document.getElementById('updateTimestamp');
    if (timestampElement) {
        timestampElement.textContent = `Última Consolidação: ${formattedDate} ${formattedTime} BRT`;
    }
  }

  // Inicialização ao carregar a página
  window.onload = function() {
    // 1. Exibe o timestamp no cabeçalho
    displayUpdateTimestamp();
    
    // 2. NOVA CHAMADA: Atualiza a contagem de eventos por dia
    updateEventCounts();

    // 3. Renderiza os incidentes abertos globalmente
    renderOpenIncidents();
    
    // 4. Define a data padrão ao carregar (Preferência: último dia com dados)
    const lastDay = "2025-11-21"; // Novo dia mais recente
    if (document.getElementById(lastDay)) {
      document.getElementById('dateSelect').value = lastDay;
      showDate(lastDay);
    } else {
      const day19 = "2025-11-19";
      document.getElementById('dateSelect').value = day19;
      showDate(day19);
    }
  };
</script>

</body>
</html>
