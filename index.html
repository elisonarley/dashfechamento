<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Diário de Bordo de Monitoramento - Black Friday 2025</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* One UI Dark Palette */
      --bg-color: #000000;
      --surface-color: #1C1C1E; /* Cinza escuro Samsung */
      --surface-color-highlight: #2C2C2E;
      
      /* Cores de Acento One UI */
      --samsung-blue: #3E91FF;
      --samsung-red: #FF453A;
      --samsung-orange: #FF9F0A;
      --samsung-green: #32D74B;
      --text-primary: #FFFFFF;
      --text-secondary: #98989E;
      
      /* Backgrounds de Status (Pastel/Suave) */
      --bg-red-subtle: rgba(255, 69, 58, 0.15);
      --bg-orange-subtle: rgba(255, 159, 10, 0.15);
      --bg-green-subtle: rgba(50, 215, 75, 0.15);
      --bg-blue-subtle: rgba(62, 145, 255, 0.15);

      --border-radius-card: 26px;
      --border-radius-inner: 18px;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-primary);
      line-height: 1.5;
      padding: 0;
      /* Simula a rolagem nativa suave */
      scroll-behavior: smooth;
    }

    /* Container Principal */
    .app-container {
      max-width: 800px; /* Largura típica de visualização móvel/tablet esticada */
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* === Viewing Area (Cabeçalho One UI) === */
    .header-area {
      padding: 60px 24px 20px 24px; /* Padding top grande para simular Viewing Area */
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .header-subtitle {
      font-size: 14px;
      color: var(--samsung-blue);
      font-weight: 700;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    h1 {
      margin: 0;
      font-size: 34px;
      font-weight: 700; /* Título Bold One UI */
      color: var(--text-primary);
    }

    /* === Date Selector & Filter Button === */
    .controls-area {
      padding: 10px 24px 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .filter-button {
      background-color: var(--samsung-red);
      color: var(--text-primary);
      padding: 14px 24px;
      border: none;
      border-radius: var(--border-radius-card);
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      transition: background-color 0.2s, transform 0.1s;
      box-shadow: 0 4px 15px rgba(255, 69, 58, 0.4);
    }
    .filter-button:hover {
      background-color: #cc372f;
    }
    .filter-button:active {
      transform: scale(0.98);
    }
    .filter-button.inactive {
        background-color: var(--surface-color);
        box-shadow: none;
        color: var(--text-secondary);
    }
    .filter-button.inactive .blink {
        animation: none; /* Desativa a animação quando o botão está inativo/filtrando */
    }
    .filter-button.active-filter {
        background-color: var(--samsung-blue);
        box-shadow: 0 4px 15px rgba(62, 145, 255, 0.4);
    }
    
    .filter-count {
      background-color: var(--surface-color-highlight);
      color: var(--samsung-red);
      padding: 2px 10px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 700;
    }

    .select-wrapper {
      position: relative;
      display: inline-block;
      width: 100%;
    }

    select {
      appearance: none;
      -webkit-appearance: none;
      width: 100%;
      padding: 16px 24px;
      font-size: 16px;
      font-family: 'Roboto', sans-serif;
      font-weight: 500;
      border-radius: var(--border-radius-card);
      border: none;
      background-color: var(--surface-color);
      color: var(--text-primary);
      cursor: pointer;
      transition: background 0.2s ease;
    }

    select:focus {
      outline: none;
      background-color: var(--surface-color-highlight);
    }

    /* Seta customizada para o select */
    .select-wrapper::after {
      content: '▼';
      font-size: 12px;
      color: var(--text-secondary);
      position: absolute;
      right: 24px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
    }
    
    /* Container para a Lista de Incidentes Abertos (abaixo do botão) */
    #openIncidentsContainer {
        padding: 0 16px;
        margin-top: 10px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    #openIncidentsList {
        display: flex;
        flex-direction: column;
        gap: 16px;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.6s cubic-bezier(0.4, 0, 0.2, 1), padding 0.6s;
    }
    
    #openIncidentsList.expanded {
        max-height: 2000px; /* Valor alto para garantir expansão */
        padding-top: 20px;
    }
    
    #openIncidentsList h2 {
        padding-left: 8px;
        margin-top: 0;
    }

    /* Estilo para os cards clonados no filtro */
    .open-incident-clone {
        border: 2px solid var(--samsung-red); /* Borda destacada para urgência */
        background-color: var(--surface-color-highlight);
        transform: scale(0.98); /* Levemente menor para diferenciar do dia ativo */
        transition: transform 0.2s;
    }
    .open-incident-clone .toggle-text {
      color: var(--samsung-blue);
      font-weight: 700;
    }


    /* === Conteúdo das Datas === */
    .content { 
      padding: 0 16px 40px; /* Margens laterais menores para cards largos */
      display: none; 
      animation: fadeUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); /* Curva One UI */
    }
    .content.active { 
      display: flex; 
      flex-direction: column;
      gap: 16px;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      font-size: 18px;
      color: var(--text-secondary);
      font-weight: 500;
      margin: 10px 8px 10px; /* Alinhado com os cards */
      padding-left: 8px;
    }

    /* === Cards de Eventos (Estilo Bolha) === */
    .event {
      background-color: var(--surface-color);
      border-radius: var(--border-radius-card);
      overflow: hidden;
      transition: background-color 0.2s, opacity 0.3s, max-height 0.3s;
      /* Propriedades para controle de filtro */
      max-height: 500px;
      opacity: 1;
    }
    
    /* Esta classe agora é inútil, mas mantida para evitar quebras em transições */
    .event.hidden-by-filter {
        /* max-height, opacity, etc. devem ser controlados no JS, mas mantidos para CSS de transição */
        display: none; 
    }

    .event:active {
      background-color: var(--surface-color-highlight); /* Feedback de toque */
    }

    .event-header {
      padding: 20px 24px;
      display: flex;
      justify-content: space-between;
      align-items: flex-start; /* Alinhamento topo para textos longos */
      cursor: pointer;
      user-select: none;
      gap: 16px;
    }

    /* Título do Evento */
    .event-title {
      font-size: 17px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.4;
      flex: 1;
    }

    /* Indicador de Cor lateral (Barra fina típica de apps de produtividade) */
    .event.border-red .event-title { color: var(--samsung-red); }
    .event.border-orange .event-title { color: var(--samsung-orange); }
    .event.border-blue .event-title { color: var(--samsung-blue); }
    .event.border-green .event-title { color: var(--samsung-green); }


    /* Header Right: Badge e Ícone */
    .header-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 12px;
      min-width: 100px; /* Espaço fixo para alinhamento */
    }

    /* === Badges (One UI Style: Sólido Pastel) === */
    .status-badge {
      font-size: 12px;
      padding: 6px 14px;
      border-radius: 50px; /* Pílula perfeita */
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border: none; /* Remove borda do estilo anterior */
    }

    .status-badge.badge-success {
      background-color: var(--bg-green-subtle);
      color: var(--samsung-green);
    }

    /* Badge Vermelho (Em Aberto) */
    .status-badge.badge-danger {
      background-color: var(--bg-red-subtle);
      color: var(--samsung-red);
    }
    
    /* Badge Amarelo/Laranja (Atenção/Validação) */
    .status-badge.badge-warning {
      background-color: var(--bg-orange-subtle);
      color: var(--samsung-orange);
    }

    /* Badge Manutenção */
    .status-badge.badge-maintenance {
      background-color: var(--bg-green-subtle); /* Manutenção é planejado = verde ou neutro */
      color: var(--samsung-green);
    }

    /* Badge Falha */
    .status-badge.badge-fail {
      background-color: var(--bg-red-subtle);
      color: var(--samsung-red);
    }

    .blink {
      animation: pulse-opacity 2s infinite;
    }

    @keyframes pulse-opacity {
      0% { opacity: 1; }
      50% { opacity: 0.6; }
      100% { opacity: 1; }
    }

    .toggle-text {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* === Timeline Area (Dentro do Card) === */
    .timeline-wrapper {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      background-color: rgba(0,0,0,0.2); /* Levemente mais escuro que o card */
    }

    .event.expanded .timeline-wrapper {
      max-height: 1500px; /* Aumentado para acomodar novas informações */
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }

    th, td {
      padding: 16px 24px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      color: #ccc;
    }

    th {
      color: var(--text-secondary);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 11px;
      letter-spacing: 1px;
      padding-top: 24px;
    }

    td:first-child, td:nth-child(2) {
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-secondary);
      font-size: 12px;
    }

    tr:last-child td { border-bottom: none; padding-bottom: 24px; }

    .status-text-green { color: var(--samsung-green); font-weight: 700; }
    .status-text-red { color: var(--samsung-red); font-weight: 700; }
    .status-text-orange { color: var(--samsung-orange); font-weight: 700; }

    /* === Rodapé ou Decoração === */
    .footer-spacer { height: 100px; }

    @media (max-width: 768px) {
      .header-area { padding-top: 40px; }
      h1 { font-size: 28px; }
      .event-header { padding: 16px 20px; }
      .status-badge { font-size: 11px; padding: 4px 10px; }
    }
    
    /* Estilos para o Índice (One UI Card Style) */
    .index-area {
      padding: 0 16px 30px; /* Padding inferior para separar do conteúdo */
      margin-top: 20px;
    }

    .index-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      margin: 0 0 15px 8px;
    }

    .index-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }

    @media (min-width: 600px) {
      .index-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    .index-day-card {
      background-color: var(--surface-color);
      border-radius: var(--border-radius-card);
      padding: 20px 24px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .index-day-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--samsung-blue);
      margin: 0 0 15px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      padding-bottom: 10px;
    }

    .index-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .index-list li {
      margin-bottom: 8px;
    }

    .index-link {
      display: block;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      padding: 8px 0;
      transition: color 0.2s;
      border-radius: 4px;
    }

    .index-link:hover {
      text-decoration: underline;
    }

    /* Cores de Status no Índice */
    .index-link.status-green { color: var(--samsung-green); }
    .index-link.status-red { color: var(--samsung-red); }
    .index-link.status-orange { color: var(--samsung-orange); }
    .index-link.status-maintenance { color: var(--samsung-blue); } /* Manutenção usa azul para ser neutro/planejado */
  </style>
</head>
<body>

<div class="app-container">
  
  <div class="header-area">
    <div class="header-subtitle">War Room • Black Friday 2025</div>
    <h1>Diário de Bordo</h1>
  </div>

  <div class="controls-area">
    <button id="filterButton" class="filter-button inactive" onclick="toggleFilter()">
        <span id="filterText">Visualizar </span>
        <span id="openCount" class="filter-count blink">0</span>
        <span id="filterLabel"> Incidentes Críticos Abertos</span>
    </button>
    <div id="openIncidentsContainer">
        <div id="openIncidentsList">
            </div>
    </div>
    
    <div class="select-wrapper">
      <select id="dateSelect" onchange="showDate(this.value)">
        <option value="">Selecionar data...</option>
        <option value="2025-11-17">17 Novembro (Seg)</option>
        <option value="2025-11-18">18 Novembro (Ter)</option>
        <option value="2025-11-19">19 Novembro (Qua)</option>
      </select>
    </div>
  </div>

  <div class="index-area">
    <h2 class="index-title">Índice de Eventos</h2>
    <div class="index-grid">
      
      <div class="index-day-card">
        <h3 class="index-day-title">17 de Novembro (Seg)</h3>
        <ul class="index-list">
          <li><a href="#event-17-1" class="index-link status-green">Pedidos Represados no Faturamento (Jund)</a></li>
          <li><a href="#event-17-2" class="index-link status-green">Disco Insuficiente - Servidor Donatello (G:)</a></li>
          <li><a href="#event-17-3" class="index-link status-green">Alto Consumo de Disco - PROD-WMS-INTEGRADOR (/)</a></li>
          <li><a href="#event-17-4" class="index-link status-green">Instabilidade Link de Internet em Jundiaí</a></li>
          <li><a href="#event-17-5" class="index-link status-red">Espaço em Disco Criticamente Baixo - GLPI-PRD-APLICACAO [/data]</a></li>
          <li><a href="#event-17-6" class="index-link status-orange">Site Sem Resposta (TRADE CREDIX WORKER)</a></li>
        </ul>
      </div>
      
      <div class="index-day-card">
        <h3 class="index-day-title">18 de Novembro (Ter)</h3>
        <ul class="index-list">
          <li><a href="#event-18-1" class="index-link status-red">Disco Criticamente Baixo - GLPI-PROXY-INVENTORY [/]</a></li>
          <li><a href="#event-18-2" class="index-link status-maintenance">Disco Criticamente Baixo - SRV-PAOLLO [/]</a></li>
          <li><a href="#event-18-3" class="index-link status-green">Falha em Rotinas e Backups - SRV-DONATELLO</a></li>
          <li><a href="#event-18-4" class="index-link status-green">Agentes Zabbix Indisponíveis (MASACCIO/GIORGIONE)</a></li>
          <li><a href="#event-18-5" class="index-link status-green">Alta Utilização de CPU - RBPSRVFS01</a></li>
          <li><a href="#event-18-6" class="index-link status-green">Alta Utilização de CPU - WHISKEY</a></li>
          <li><a href="#event-18-7" class="index-link status-red">Queda de Link (Americanet) - FGT_JDI</a></li>
        </ul>
      </div>
      
    </div>
  </div>

  <div id="2025-11-17" class="content">
    <h2>Eventos de Segunda-feira</h2>

    <div id="event-17-1" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INCIDENTE #2511170003: Represamento no Faturamento (Jund)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:31:00</td><td>Gleice</td><td>Acionamento inicial: Faturamento paralisado.</td></tr>
          <tr><td>08:37:00</td><td>Pablo</td><td>Verificação: Robôs do Jundiaí [OK]. Pedido das 08:10 represado na Separação liberado. Fluxo retomado.</td></tr>
          <tr><td>08:40:00</td><td>Sistema</td><td><span class="status-text-green">RESOLVIDO</span> Fluxo de faturamento normalizado. (Causa: Represamento pontual)</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-2" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Disco Insuficiente – SRV-DONATELLO (G:)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:09:00</td><td>Zabbix</td><td>Alerta de disco (G:). Free: 573.1 GB.</td></tr>
          <tr><td>08:11:00</td><td>Gabriel</td><td>Hipótese: Falha na exclusão do backup anterior. Acionado time de DB.</td></tr>
          <tr><td>10:03:00</td><td>G. Soares</td><td>Ação: Ajuste de trigger para 500 GB.</td></tr>
          <tr><td>10:20:00</td><td>G. Soares</td><td>Movendo backup full + checkdb (G: -> E:). Upload para S3 agendado.</td></tr>
          <tr><td>11:16:00</td><td>Monitor</td><td><span class="status-text-green">NORMALIZADO</span> Disco retornou para 42% de uso.</td></tr>
          <tr><td>18:15:00</td><td>Fabio (Teams)</td><td><span class="status-text-green">CAUSA RAIZ ENCONTRADA</span> Walmir informou que o horário do Backup de Image Level da Equinix foi alterado (de 02:00h) para evitar conflito com o backup do banco de dados. Este conflito causava instabilidade no cluster.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-3" class="event border-blue" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Alto Consumo de Disco – PROD-WMS-INTEGRADOR (/)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:54:00</td><td>Pablo</td><td>Acionamento: Alerta filesystem root (/). Utilização: 97%.</td></tr>
          <tr><td>08:46:00</td><td>Murilo</td><td>Suporte N2 acionado para limpeza de logs.</td></tr>
          <tr><td>09:44:00</td><td>Murilo</td><td><span class="status-text-green">RESOLVIDO</span> Espaço recuperado após limpeza de temps.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-4" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Instabilidade Link Jundiaí</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>16:25:00</td><td>Elison</td><td>Identificada latência alta/perda de pacote em Jundiaí.</td></tr>
          <tr><td>16:28:00</td><td>Matheus</td><td>Queda confirmada de ~3min. Oscilação diária padrão da operadora.</td></tr>
          <tr><td>16:30:00</td><td>Elison</td><td>Serviços normalizados.</td></tr>
        </table>
      </div>
    </div>
    
    <div id="event-17-5" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Espaço em Disco - GLPI-PRD-APLICACAO [/data]</div>
        <div class="header-right">
          <span class="status-badge badge-danger blink">Em Aberto</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>17/11 12:10</td><td>Elison Arley</td><td>Questiona retorno do GLPI. Uso de disco em 95.7% (156.4GB total).</td></tr>
          <tr><td>17/11 12:10</td><td>Zabbix</td><td>PROBLEM: FS [/data] Critically low (used > 90%).</td></tr>
          <tr><td>18/11 12:46</td><td>Fábio Jose</td><td><span class="status-text-red">URGENTE</span> Necessidade de RDM Emergencial para expurgo de base. Cobrança de mapeamento ao Gabriel Ribeiro. Kaue Silva adicionado.</td></tr>
          <tr><td>18/11 16:12</td><td>Fábio Jose</td><td>Cobrança: Gabriel Ribeiro Viana Aguiar algum retorno?</td></tr>
          <tr><td>18/11 18:16</td><td>Gabriel Ribeiro</td><td>Informou relação de grupos para expurgo. Fábio informou que precisa dos caminhos (patchs) ou script via banco.</td></tr>
          <tr><td>18/11 18:49</td><td>Fellipe Soares (DBA)</td><td>Informou que irá precisar montar o script para todas as pastas citadas.</td></tr>
          <tr><td>18/11 19:15</td><td>Gabriel Ribeiro</td><td>Reforçou a importância de manter os arquivos expurgados em outra "Maquina".</td></tr>
        </table>
      </div>
    </div>

    <div id="event-17-6" class="event border-orange" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">WARNING: Site Sem Resposta (TRADE CREDIX WORKER CONSUMER DLQ)</div>
        <div class="header-right">
          <span class="status-badge badge-fail">Ignorado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>17/11 15:49</td><td>Zabbix</td><td>PROBLEM: Site sem responder há mais de 5 min. Status: *UNKNOWN*. Duração: 1d 1h 2m.</td></tr>
          <tr><td>16:00:00</td><td>Callel</td><td><span class="status-text-orange">IGNORADO</span> Devido ao *freezing* (período de congelamento de mudanças/serviços), será tratado após a Black Friday.</td></tr>
        </table>
      </div>
    </div>
  </div>

  <div id="2025-11-18" class="content">
    <h2>Eventos de Hoje</h2>

    <div id="event-18-1" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Disco Criticamente Baixo - GLPI-PROXY-INVENTORY [/]</div>
        <div class="header-right">
          <span class="status-badge badge-danger blink">Em Aberto</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:00:27</td><td>L. Gomes</td><td>PROBLEM: FS [/] Critically low (> 90%, total 7.6GB). Atual: 90.9%</td></tr>
          <tr><td>07:47:00</td><td>L. Gomes</td><td>Escalado para o NOC.</td></tr>
          <tr><td>10:21:00</td><td>Operação</td><td><span class="status-text-red">EM ABERTO</span> Aguardando ação corretiva.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-2" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Disco Criticamente Baixo - SRV-PAOLLO [/]</div>
        <div class="header-right">
          <span class="status-badge badge-maintenance">Manutenção</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>08:42:43</td><td>Zabbix</td><td>PROBLEM: FS [/] Critically low (> 90%, total 44.0GB). Atual: 92.6%</td></tr>
          <tr><td>10:49:00</td><td>Operação</td><td><span class="status-text-red">EM ABERTO</span> Ainda sem resposta / ação corretiva registrada.</td></tr>
          <tr><td>14:56:00</td><td>Daily Teams</td><td><span class="status-text-green">MANUTENÇÃO</span> Kaue informou que está realizando manutenção no servidor e ficará indisponível.</td></tr>
          <tr><td>16:32:00</td><td>Kaue Silva</td><td>Solicitou que o Paollo seja deixado em manutenção por 30 dias para resolver a questão comercial dos discos, pois ficará alarmando.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-3" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">FALHA: Rotinas de Backup - SRV-DONATELLO</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>07:39:00</td><td>L. Gomes</td><td>Reportado falha em jobs SQL no Donatello.</td></tr>
          <tr><td>08:14:00</td><td>G. Soares</td><td>Diagnóstico: Latência alta de escrita (Disco G:). Backup rodando há 14h.</td></tr>
          <tr><td>08:20:00</td><td>L. Gomes</td><td>Escalado para o NOC. Zabbix reportou falhas nos jobs: DBA_Rotinas Administrativas - (Backup Log), DBA_Rotinas Administrativas - (Truncate Log File (Jundsoft)), e Log backup older than 8h para as DBs AlliedCorreios, AlliedServicos, Cotacao, DBADashDB, JUNDSOFT.</td></tr>
          <tr><td>12:07:00</td><td>G. Soares</td><td>Backup de transação travado. Decisão: Cancelar backup para ação da Equinix.</td></tr>
          <tr><td>12:58:00</td><td>F. Jose</td><td>Equinix acionada. Agenda solicitada para a tarde com time de DB.</td></tr>
          <tr><td>13:08:00</td><td>F. Jose</td><td><span class="status-text-orange">EQUINIX UPDATE</span> "Ocorreu uma falha de rede na estrutura do backup, onde a rotina ficou em status de execução, gerando incremento no disco do servidor. Foi efetuada correção."</td></tr>
          <tr><td>13:08:00</td><td>E. Arley</td><td><span class="status-text-orange">Aguardando validação.</span></td></tr>
          <tr><td>19/11 10:00</td><td>E. Arley</td><td><span class="status-text-orange">PENDENTE</span> Cobrar atualização do time de banco sobre a execução do backup.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-4" class="event border-green" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">INFO: Agentes Zabbix Indisponíveis (MASACCIO e GIORGIONE)</div>
        <div class="header-right">
          <span class="status-badge badge-success">Resolvido</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>14/11 10:02</td><td>Zabbix</td><td>PROBLEM: MASACCIO - Zabbix agent is not available (duração: 4d 28m).</td></tr>
          <tr><td>13/11 17:02</td><td>Zabbix</td><td>PROBLEM: GIORGIONE - Zabbix agent is not available (duração: 4d 17h 29m).</td></tr>
          <tr><td>10:34:28</td><td>Operação</td><td>Ação: Servidores em modo de manutenção no Zabbix para investigação.</td></tr>
          <tr><td>10:35:00</td><td>Kaue Silva</td><td>Solicitou desativação e remoção da monitoração.</td></tr>
          <tr><td>10:37:00</td><td>Operação</td><td><span class="status-text-green">RESOLVIDO</span> Monitoração desativada a pedido.</td></tr>
          <tr><td>10:38:00</td><td>E. Arley</td><td>Servidores desativados.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-5" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">ALERTA: Alta Utilização de CPU - RBPSRVFS01</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:48:20</td><td>Zabbix</td><td>PROBLEM: High CPU utilization (> 90% por 5m). Atual: 99.97%.</td></tr>
          <tr><td>11:00:00</td><td>E. Arley</td><td>Escalado para o NOC.</td></tr>
          <tr><td>11:01:00</td><td>M. Rodrigues</td><td>Causa: Scan manual do Windows Defender em andamento (Ricardo Henrique).</td></tr>
          <tr><td>11:05:00</td><td>Fabio Santos</td><td><span class="status-text-green">NORMALIZADO</span> Scan pausado. Alinhamento realizado com Ricardo para comunicação prévia de atividades.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-6" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">ALERTA: Alta Utilização de CPU - WHISKEY</div>
        <div class="header-right">
          <span class="status-badge badge-success">Normalizado</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>10:11:38</td><td>Zabbix</td><td>PROBLEM: High CPU utilization (> 90% por 5m). Atual: 100%.</td></tr>
          <tr><td>11:00:00</td><td>E. Arley</td><td>Escalado para o NOC.</td></tr>
          <tr><td>11:01:00</td><td>M. Rodrigues</td><td>Causa: Scan manual do Windows Defender em andamento (Ricardo Henrique).</td></tr>
          <tr><td>11:05:00</td><td>Fabio Santos</td><td>Alinhamento realizado com Ricardo para comunicação prévia. Scan supostamente pausado.</td></tr>
          <tr><td>13:06:00</td><td>E. Arley</td><td>CPU ainda em 100% mesmo após o suposto "stop".</td></tr>
          <tr><td>14:30:00</td><td>Murillo</td><td>Verificado que o Defender não havia sido parado.</td></tr>
          <tr><td>15:20:00</td><td>E. Arley</td><td><span class="status-text-green">NORMALIZADO</span> CPU normalizada.</td></tr>
        </table>
      </div>
    </div>

    <div id="event-18-7" class="event border-red" onclick="toggleEvent(this)">
      <div class="event-header">
        <div class="event-title">CRITICAL: Queda de Link (Americanet) - FGT_JDI</div>
        <div class="header-right">
          <span class="status-badge badge-danger blink">Em Aberto</span>
          <span class="toggle-text">Detalhes ▼</span>
        </div>
      </div>
      <div class="timeline-wrapper">
        <table>
          <tr><th width="15%">Horário</th><th width="15%">Ator</th><th>Ação / Detalhes</th></tr>
          <tr><td>14:26:32</td><td>E. Arley</td><td>PROBLEM: Queda no Link da Americanet em Jundiaí.</td></tr>
          <tr><td>14:29:00</td><td>Matheus (JDI)</td><td>Evidência enviada.</td></tr>
          <tr><td>15:11:00</td><td>Matheus (JDI)</td><td><span class="status-text-red">UPDATE PROVEDOR</span> Incidente crítico no backbone principal. Indisponibilidade total. Previsão: 8 horas. Chamado: #2511188538.</td></tr>
          <tr><td>16:59:00</td><td>Matheus (JDI)</td><td>Reportou indisponibilidade no TS-JUND load balancer.</td></tr>
          <tr><td>17:20:00</td><td>E. Arley</td><td><span class="status-text-orange">PARCIALMENTE RESTABELECIDO</span> Acesso ao TS-JUND ok, mas operando por apenas um link. Aguardando retorno sobre ações tomadas.</td></tr>
          <tr><td>17:21:00</td><td>E. Arley</td><td><span class="status-text-red">EM ABERTO</span> Link da Americanet continua FORA.</td></tr>
        </table>
      </div>
    </div>

  </div>

  <div id="2025-11-19" class="content">
    <h2>Eventos de Quarta-feira</h2>
    </div>

  <div class="footer-spacer"></div>
</div>

<script>
  let isFilterActive = false;

  // Função para renderizar os incidentes abertos na lista global
  function renderOpenIncidents() {
    const openIncidentsList = document.getElementById('openIncidentsList');
    const openCountSpan = document.getElementById('openCount');
    
    // Limpa a lista antes de renderizar
    openIncidentsList.innerHTML = '';

    // Encontra todos os eventos com o status "Em Aberto"
    const openEvents = document.querySelectorAll('.event .badge-danger.blink');
    
    openCountSpan.textContent = openEvents.length;

    if (openEvents.length > 0) {
        openEvents.forEach(badge => {
            const eventCard = badge.closest('.event');
            const clone = eventCard.cloneNode(true);
            
            // --- INÍCIO DA CORREÇÃO ---
            // 1. Adiciona a classe 'open-incident-clone' para estilização de filtro
            clone.classList.add('open-incident-clone');
            
            // 2. Garante que o card clonado esteja EXPANDIDO para exibir os detalhes
            clone.classList.add('expanded');
            
            // 3. Atualiza o texto de toggle (Detalhes) para a lista de abertos
            const toggleText = clone.querySelector('.toggle-text');
            if (toggleText) {
                toggleText.textContent = 'Ver Card Original ↗';
            }
            // Remove o onclick do clone para não colapsar na lista de abertos
            clone.onclick = null;
            
            // Adiciona um link para o card original (Nova função de click)
            clone.addEventListener('click', () => {
                // Extrai a data do ID do container pai
                const dateId = eventCard.parentElement.id;
                document.getElementById('dateSelect').value = dateId;
                showDate(dateId);
                
                // Rola para o card original
                setTimeout(() => {
                    document.getElementById(eventCard.id).scrollIntoView({ behavior: 'smooth', block: 'center' });
                    // Pisca o card original para destaque
                    eventCard.style.transition = 'background-color 0.1s';
                    setTimeout(() => eventCard.style.backgroundColor = 'var(--surface-color-highlight)', 100);
                    setTimeout(() => eventCard.style.backgroundColor = 'var(--surface-color)', 500);
                }, 400); // Espera a animação de troca de dia
            });
            
            // --- FIM DA CORREÇÃO ---
            
            openIncidentsList.appendChild(clone);
        });
        document.getElementById('filterButton').classList.remove('inactive');
    } else {
        openCountSpan.classList.remove('blink');
    }
  }

  // Função principal de filtro (agora apenas gerencia a exibição da lista global)
  function toggleFilter() {
    const listContainer = document.getElementById('openIncidentsList');
    
    // Alterna o estado do filtro (expande/contrai a lista)
    isFilterActive = !isFilterActive;
    listContainer.classList.toggle('expanded', isFilterActive);
    
    const filterButton = document.getElementById('filterButton');
    filterButton.classList.toggle('active-filter', isFilterActive);
    
    if (isFilterActive) {
      filterButton.querySelector('#filterText').textContent = 'Ocultar ';
    } else {
      filterButton.querySelector('#filterText').textContent = 'Visualizar ';
    }
  }
  
  // Função para exibir o conteúdo da data selecionada
  function showDate(value) {
    // Garante que o filtro esteja fechado ao mudar a data
    if (isFilterActive) {
        toggleFilter();
    }
    
    const contents = document.querySelectorAll('.content');
    contents.forEach(el => el.classList.remove('active'));
    
    if (value) {
      setTimeout(() => {
        document.getElementById(value).classList.add('active');
        // A contagem não precisa ser atualizada aqui, pois é global
      }, 50);
    }
  }
  
  function toggleEvent(element) {
    element.classList.toggle('expanded');
  }

  // Inicialização ao carregar a página
  window.onload = function() {
    // 1. Renderiza os incidentes abertos globalmente
    renderOpenIncidents();
    
    // 2. Define a data padrão ao carregar (Preferência: último dia com dados)
    const lastDay = "2025-11-18";
    if (document.getElementById(lastDay)) {
      document.getElementById('dateSelect').value = lastDay;
      showDate(lastDay);
    }
  };
</script>

</body>
</html>
